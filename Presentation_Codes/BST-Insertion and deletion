#include<stdio.h>
#include<stdlib.h>

struct node {
    int key;
    struct node * left;
    struct node * right;
};

struct node * insert(struct node * root,int key);
struct node * createnode(int key);
struct node * deletenode(struct node * root,int val);
struct node * minValue(struct node * root);
void preorder(struct node * root);

void main(){
    
    struct node * root=NULL;
    
    int i;
    printf("\nEnter the BST tree elements");
    
    do{
        printf("\nElement:");
        scanf("%d",&i);
        root=insert(root,i);
        printf("More node : ");
        scanf("%d",&i);
    }while(i==1);
    
    printf("\nTree created\n");
    preorder(root);
    
    printf("\nEnter element to delete:");
    scanf("%d",&i);
    root=deletenode(root,i);
    
    printf("\nTree after deletion of %d \n",i);
    preorder(root);
}

struct node * insert(struct node * root,int key){
    if(root==NULL){
        return createnode(key);
    }
    if(key<root->key){
        root->left=insert(root->left,key);
    }
    else if(key>root->key){
        root->right=insert(root->right,key);
    }
    else{
        return root;
    }
    return root;
}

struct node * createnode(int key){
    struct node * NN=(struct node *)malloc(sizeof(struct node));
    NN->key=key;
    NN->left=NN->right=NULL;
    return NN;
}

struct node * deletenode(struct node * root,int val){
    if(root==NULL){//No tree
        printf("\nNo element to delete!");
        return root;
    }
    if(val<root->key){
        root->left=deletenode(root->left,val);
    }
    else if(val>root->key){
        root->right=deletenode(root->right,val);
    }
    else{
        
        if(root->left==NULL&&root->right==NULL){//No child
            free(root);
            return NULL;
        }
        
        //One child
        if(root->left==NULL){
            struct node * temp=root->right;
            free(root);
            return temp;
        }
        
        else if(root->right==NULL){
            struct node * temp=root->left;
            free(root);
            return temp;
        }
        
        //Two children
        struct node * temp=minValue(root->right);
        root->key=temp->key;
        root->right=deletenode(root->right,temp->key);
    }
    return root;
}

struct node * minValue(struct node * root){
    struct node * curr=root;
    while(curr->left!=NULL){
        curr=curr->left;
    }
    return curr;
}

void preorder(struct node * root){
    if(root!=NULL){
        printf("%d ",root->key);
        preorder(root->left);
        preorder(root->right);
    }
}

